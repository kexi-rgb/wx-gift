<script>
  const content = `é‡åˆ°ä»€ä¹ˆäº‹å•¦ï¼ˆï½€Î”Â´ï¼‰ã‚ï¼Ÿ  
è¢«è°æ¬ºè´Ÿäº†ï¼æˆ‘å°†æ‚„æ‚„è¯…å’’ä»–ï¼  
ä¸è¦ä¸å¼€å¿ƒï¼Œæ­å–œä½ ä¸­å¤§å¥–~  
ä¸“å±äºä½ ä¸€ä¸ªäººç‰¹åˆ«å¥–åŠ±  
åœ¨24å°æ—¶å†…å°†å…‘ç°  
è¯·æŸ¥æ”¶ï¼  
å¦‚æœç”Ÿæ´»è®©ä½ ä¸å¦‚æ„ï¼Œä¸å¦‚å‡ºå»èµ°èµ°çœ‹çœ‹ï¼`;

  const textElement = document.getElementById('text');
  const cursor = document.getElementById('cursor');
  const loader = document.getElementById('loader');
  const progressBar = document.getElementById('progress-bar');
  const mainContent = document.getElementById('main-content');
  const bgm = document.getElementById('bgm');
  let i = 0;

  // === å‡è¿›åº¦æ¡åŠ¨ç”» ===
  let progress = 0;
  const fakeLoading = setInterval(() => {
    progress += Math.random() * 10;
    if (progress > 100) progress = 100;
    progressBar.style.width = progress + "%";
    if (progress >= 100) {
      clearInterval(fakeLoading);
      setTimeout(() => {
        loader.style.opacity = 0;
        loader.style.visibility = "hidden";
        mainContent.style.opacity = 1;
        showOpenButton();
      }, 600);
    }
  }, 200);

  // === æ˜¾ç¤ºâ€œæ‹†å¼€ä¿¡å°â€æŒ‰é’® ===
  function showOpenButton() {
    const btn = document.createElement("button");
    btn.textContent = "ğŸ’Œ æ‹†å¼€ä¿¡å°";
    btn.style.marginTop = "20px";
    btn.style.padding = "10px 20px";
    btn.style.border = "1px solid #666";
    btn.style.background = "rgba(255,255,255,0.1)";
    btn.style.color = "#eee";
    btn.style.borderRadius = "8px";
    btn.style.fontFamily = "'Noto Serif SC', serif";
    btn.style.cursor = "pointer";
    btn.style.transition = "all 0.3s ease";
    btn.onmouseenter = () => btn.style.background = "rgba(255,255,255,0.2)";
    btn.onmouseleave = () => btn.style.background = "rgba(255,255,255,0.1)";
    mainContent.appendChild(btn);

    btn.addEventListener("click", async () => {
      btn.disabled = true;
      btn.textContent = "æ­£åœ¨æ‹†å¼€ä¸­...";
      try {
        const res = await fetch("https://notify.wxgift.top/");
        console.log("Notify sent:", await res.text());
      } catch (err) {
        console.warn("Notify API failed:", err);
      }
      btn.style.opacity = "0";
      setTimeout(() => btn.remove(), 500);
      startTyping();
      tryPlayBgm();
    });
  }

  // === æ‰“å­—æœºæ•ˆæœ ===
  function startTyping() {
    if (i < content.length) {
      textElement.textContent += content[i];
      i++;
      setTimeout(startTyping, 70);
    } else {
      cursor.style.display = 'none';
    }
  }

  // === å°è¯•æ’­æ”¾éŸ³ä¹ ===
  function tryPlayBgm() {
    if (bgm) {
      bgm.play().catch(() => {
        console.log("ç­‰å¾…ç”¨æˆ·ç‚¹å‡»ä»¥æ’­æ”¾éŸ³ä¹");
      });
    }
  }
</script>
